<mat-card class="cardWithShadow theme-card">
    <mat-card-header>
      <mat-card-title class="m-b-0" id="titreNumCourant">Numéro Courant : {{numeroCourant}} </mat-card-title>
    </mat-card-header>
    <mat-card-content class="b-t-1">
      <div class="vertical-text-moyenne">La moyenne X̄</div>
      <div   style="width: 100%; height: 400px;" >
        <apx-chart 
        [series]="chartOptionsMoyenne.series"
        [chart]="chartOptionsMoyenne.chart"
        [xaxis]="chartOptionsMoyenne.xaxis"
        [yaxis]="chartOptionsMoyenne.yaxis"
        [stroke]="chartOptionsMoyenne.stroke"
        [dataLabels]="chartOptionsMoyenne.dataLabels"
        [markers]="chartOptionsMoyenne.markers"
        [tooltip]="chartOptionsMoyenne.tooltip"
        [annotations]="chartOptionsMoyenne.annotations"
        [fill]="chartOptionsMoyenne.fill"
        [legend]="chartOptionsMoyenne.legend"
        style="position: absolute;width: 940px; margin-top: -20px;">
      </apx-chart>
      </div>
      <div class="vertical-text-etendu">L'étendu R </div>
      <div  style="width: 100%; height: 250px;">
        <apx-chart 
        [series]="chartOptionsEtendue.series"
        [chart]="chartOptionsEtendue.chart"
        [xaxis]="chartOptionsEtendue.xaxis"
        [yaxis]="chartOptionsEtendue.yaxis"
        [stroke]="chartOptionsEtendue.stroke"
        [dataLabels]="chartOptionsEtendue.dataLabels"
        [markers]="chartOptionsEtendue.markers"
        [tooltip]="chartOptionsEtendue.tooltip"
        [annotations]="chartOptionsEtendue.annotations"
        style=" position: absolute;width: 940px; margin-top:-20px;">
      </apx-chart>
      </div>
      <br> <br>
        <div class="form-container">
          <!-- Première colonne (gauche) -->
          <div class="form-column">
            <mat-label class="f-w-600 m-b-30 d-block">Type de pistolet : &nbsp;
              <span class="labelCoupePropre">Pistolet Vert</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Numéro de pistolet : &nbsp;
              <span class="labelCoupePropre">{{pistolet.numeroPistolet}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Coupe Propre : &nbsp;
              <span class="labelCoupePropre">{{pistolet.coupePropre}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Nombre de collier tester : &nbsp;
              <span class="labelCoupePropre">{{pistolet.nbrCollierTester}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Axe de serrage : &nbsp;
              <span class="labelCoupePropre">{{pistolet.axeSerrage}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Semaine : &nbsp;
              <span class="labelCoupePropre">{{pistolet.semaine}}</span>
            </mat-label>
          </div>
      
          <!-- Deuxième colonne -->
          <div class="form-column">
            <mat-label class="f-w-600 m-b-30 d-block">Échantillon 1 : &nbsp;
              <span class="labelCoupePropre">{{pistolet.ech1}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Échantillon 2 : &nbsp;
              <span class="labelCoupePropre">{{pistolet.ech2}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Échantillon 3 : &nbsp;
              <span class="labelCoupePropre">{{pistolet.ech3}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Échantillon 4 : &nbsp;
              <span class="labelCoupePropre">{{pistolet.ech4}}</span>
            </mat-label>
            <mat-label class="f-w-600 m-b-30 d-block">Échantillon 5 : &nbsp;
              <span class="labelCoupePropre">{{pistolet.ech5}}</span>
            </mat-label>
            <mat-label class="grid-label-container">
              <span>Moyenne X̄ : &nbsp;<span class="labelCoupePropre">{{pistolet.moyenne}}</span></span>
              <span class="right-text">Étendue R = &nbsp;<span class="labelCoupePropre">{{pistolet.etendu}}</span></span>
            </mat-label>
          </div>
        </div>
        <div class="actions">
          <button mat-flat-button color="primary" class="m-r-8" id="btnSave" type="button" (click)="naviger()">
            Voir PDEK
          </button>
        
          <!-- ✅ Cas 1 : Pistolet validé => bouton désactivé en rouge -->
          <ng-container *ngIf="valide; else verifierActivation">
            <button mat-flat-button class="bg-danger text-black" disabled>
              PDEK déjà validé
            </button>
          </ng-container>
        
          <!-- ✅ Cas 2 ou 3 : on vérifie activationValider -->
          <ng-template #verifierActivation>
            <ng-container *ngIf="pistolet.activationValider;">
              <button
                mat-flat-button
                class="bg-success text-white"
                (click)="validerPdekPistolet()"
              >
                Valider PDEK
              </button>
            </ng-container>
          </ng-template>
        
          <!-- ✅ Cas 3 : Pistolet non conforme 
          <ng-template #templateCreerPlanAction>
            <button mat-flat-button class="bg-warning text-white" (click)="creerPlanAction()">
              Créer Plan d'action
            </button>
          </ng-template>-->
        </div>         
    </mat-card-content>
  </mat-card>